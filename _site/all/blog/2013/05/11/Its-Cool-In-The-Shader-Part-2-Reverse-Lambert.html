<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"  />
	<meta name="description" content="Kyle Halladay Game Development" />
	<meta name="keywords" content="life,code,software,development,games,ludology,indie" />
	<link rel="stylesheet" type="text/css" href="/css/default.css" />
	<link rel="stylesheet" type="text/css" href="/css/pretty_code.css" />
	<link rel="stylesheet" href="/css/highlight_default.css">
	<script src="/javascripts/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

<title>Kyle Halladay - Toronto Game Developer</title>
</head>

<body>
	<div id="wrap">
		<div id="header">
			<p id="toplinks">
			</p>
			<h1><a href="/" class="logo"><div id="logo"></div></a><a href="/" class="logo">K</a><a href="/" class="logo">y</a><a href="/" class="logo">l</a><a href="/" class="logo">e</a> <a href="/" class="logo">H</a><a href="/" class="logo">a</a><a href="/" class="logo">l</a><a href="/" class="logo">l</a><a href="/" class="logo">a</a><a href="/" class="logo">d</a><a href="/" class="logo">a</a><a href="/" class="logo">y</a></h1>
			<div class="slogan"> 
					<a href="/" class="paleorange">Home</a> ||
					<a href="/archive.html" class="paleorange">Archive</a> ||
					<a href="/portfolio.html" class="paleorange">Games</a> ||
					<a href="/graphics.html" class="paleorange">Graphics</a> ||
					<a href="/aboutme.html" class="paleorange">About Me</a>
			</div>
	</div>
<div id="content">  
  <span class = "post_title">
<h2>It&apos;s Cool In The Shader Part 2&#58; Reverse Lambert Shading</h2>
</span>

<div id="post">
<br>
<p>The second week of my shader odyssey was a lot of fun. The lesson from Unity Cookie involved implementing a 1 light lambert shader that took into account ambient lighting. This would have been enough to be “cool” by itself, but I also went ahead and modified the lesson a bit to do something I’ve always wanted to see done: a lighting model that works in reverse, that is, things in the light are darkened, and things away from the light are lit up.</p>

<p>I’m making it a point to understand the math behind each week’s shader, so I’ll explain the math behind the lambert shader, and the dark/light switch modification first, and then post the code. The lambert lighting model is summarized in the equation</p>

<p>I<sub>D</sub> = L · N * C * I<sub>L</sub> <br /> (or: The intensity of the diffuse light (I<sub>D</sub>) on a surface is equal to the dot product of the surface’s normal vector and the normalized direction of the light (L · N), multiplied by the Color (C) and intensity of the incoming light (I<sub>L</sub>))</p>

<p>The tutorial goes a bit further. We added a max function to the dot product which clamped the values to between 0.0 and 1.0. This prevented the areas of the objects which were facing away from the light source from being darkened to a value less than having no light shining on it. The equation was also modified to add ambient light calculations, meaning that objects facing perfectly away from the light source would be coloured exactly the colour of the ambient light in the scene. The end result of this was a lighting equation that looked like this (A = ambient light colour):</p>

<p>I<sub>D</sub> = ( max(0.0,L · N ) * C * I<sub>L</sub>) + A</p>

<p>The modification was much simpler than I initially expected. All that needs to be done to the above equation to reverse the lighting calculation is to calculate I<sub>D</sub> using -N, that is, as if the surface’s normal vector is pointing in the opposite direction.</p>

<p>The end result is simply I<sub>D</sub> = ( max(0.0,L · -N ) * C * I<sub>L</sub>) + A</p>

<p>Changing just the direction of the normal vector allows you to use the rest of the equation unchanged, allowing you to still take advantage of the max function without needing to fiddle with any values. I’m not entirely convinced that this would work in all cases (particularly with really intricate meshes), but I can’t think of any good reason why it wouldn’t (if you can, grab me <a href="http://twitter.com/khalladay">on Twitter</a>. I also make no guarantees that the math above is perfectly explained or correct. To me it makes sense, but this is only week 2 of my long journey towards competency in shader programming, so feel free to shoot any corrections my way as well.</p>

<p>Finally, now that you’ve sat through my oh so titillating exploration of the math involved this week, here’s the modified shader I came up with. It’s exactly 1 character different from the tutorial’s shader so don’t get your hopes up, but playing with the shader and tinkering to get to this point was definitely worthwhile.</p>
<script class='gist' src='https://gist.github.com/khalladay/d77a2bcd09de1e726906.js'><![CDATA[&nbsp;]]></script>
</div>


<div id="related">
  <h3>Recent Posts</h3>
  <ul class="posts">
    
      <li><span>08 Feb 2014</span> &raquo; <a href="/all/blog/2014/02/08/Introducing-UUNit-SL-unit-testing-for-shaders.html">Introducing UUnit-SL, Unit tests for Shaders</a></li>
    
      <li><span>12 Jan 2014</span> &raquo; <a href="/all/blog/2014/01/12/Runtime-Shader-Compilation-Unity.html">Creating GLSL Shaders at Runtime in Unity3D</a></li>
    
      <li><span>06 Jan 2014</span> &raquo; <a href="/all/blog/2014/01/06/Hacking-My-Attention-Span.html">Automating SelfControl in OS X Mavericks</a></li>
    
      <li><span>24 Dec 2013</span> &raquo; <a href="/all/blog/2013/12/24/Ray-Sphere-Intersection.html">Ray-Sphere Intersection with Simple Math</a></li>
    
      <li><span>10 Nov 2013</span> &raquo; <a href="/all/blog/2013/11/10/Libpd-and-Unity.html">Combining Pure Data and Unity</a></li>
    
      <li><span>13 Oct 2013</span> &raquo; <a href="/all/blog/2013/10/13/Multi-Light-Diffuse.html">Writing Multi-Light Pixel Shaders in Unity</a></li>
    
      <li><span>28 Sep 2013</span> &raquo; <a href="/all/blog/2013/09/28/How-to-dissolve-effect.html">Making a Dissolve Effect with Surface Shaders</a></li>
    
      <li><span>02 Sep 2013</span> &raquo; <a href="/all/blog/2013/09/02/A-Simple-Flowmap.html">A Simple Flow Map</a></li>
    
      <li><span>13 Aug 2013</span> &raquo; <a href="/all/blog/2013/08/13/Coloured-Shadows.html">Multi Coloured Shadows In Unity</a></li>
    
      <li><span>20 Jul 2013</span> &raquo; <a href="/all/blog/2013/07/20/Down-The-Rabbit-Hole.html">Down The Rabbit Hole</a></li>
    
  </ul>
</div>

<br>
<br>
</div>

<div id="footer">

	<a href="mailto:k.mj.halladay@gmail.com" class="footerlink">E-mail</a> |
	<a href="https://github.com/khalladay" class="footerlink">Github</a> |
    <a href="http://ca.linkedin.com/pub/kyle-halladay/2b/658/a14/" class="footerlink">LinkedIn</a> |
	<a href="https://www.shadertoy.com/user/khalladay" class="footerlink">ShaderToy</a> |
    <a href="http://twitter.com/khalladay" class="footerlink">Twitter</a>

<p>&copy; 2013 <a href="/aboutme.html" class="footerlink">Kyle Halladay</a>

</div>
</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-40292745-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

