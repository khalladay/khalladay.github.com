<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"  />
<meta name="description" content="Dan Hixon Codes" />
<meta name="keywords" content="video,games,programming,software,development,unity3d" />
<meta name="author" content="Dan Hixon" />
<link rel="stylesheet" type="text/css" href="/css/default.css" />
<link rel="stylesheet" type="text/css" href="/css/pretty_code.css" />
<link rel="alternate" type="application/atom+xml" href="http://danhixon.github.com/atom.xml" />

<title>kylehalladay.com</title>
</head>

<body>
<div id="wrap">
	<div id="header">
		<p id="toplinks">

		</p>

		<h1><a href="/"><div id="logo"></div>Ã¼ber<span class="fade">duper</span></a></h1>
		<div class="slogan">
				<a href="/code.html" class="pink">code{web}</a> :|: 
				<a href="/os.html" class="green">software{apple}</a> :|: 
				<a href="/life.html" class="orange">life{me}</a>
		</div>

</div>

<div id="content">  
  <div id="post">
<h2>Handsoap with <span class="caps">ASP</span>.Net</h2>
<p class="publish_date">30 Sep 2009</p>
<p>Soap4r wasn&#8217;t unusable for me but I didn&#8217;t like using it. When things lined up correctly everything was rosy but trying to debug when a problem occurred was very difficult.  <a href="http://github.com/troelskn/handsoap">Handsoap</a> to the rescue.</p>
<p>Handsoap doesn&#8217;t try to do your work for you, it just tries to get out of the way and perform the lower level http calls while providing a toolbox and pattern to help you generate xml requests and parse xml responses.  I&#8217;m not going to give a further description.  I just want to walk through how I use it with <span class="caps">ASP</span>.Net web services.</p>
<h3>Use <span class="caps">ASP</span>.net Previews</h3>
<p><span class="caps">ASP</span>.net 2.0 &#8220;.asmx&#8221; files get rendered in a browser as a human readable list of <span class="caps">SOAP</span> methods. When you click on a method name it renders a helpful set of <span class="caps">SOAP</span> 1.1 and <span class="caps">SOAP</span> 1.2 sample request and response.</p>
<p><img src="/images/asmx_method_list.png" title="List of ASP.Net Methods" alt="List of ASP.Net Methods" /></p>
<p><img src="/images/asmx_samples.png" title="List of ASP.Net sample request and response" alt="List of ASP.Net sample request and response" /></p>
<h3>Tests to Parse the Response</h3>
<p>I don&#8217;t write tests to ensure my requests are correct.  I should but for now I just test that I am parsing the response correctly.  This example just returns a simple string so I copy the sample response <span class="caps">XML</span> from the web service and paste it into a test like below and replace the place holder &#8220;string&#8221; with a sample value &#8220;jojojo&#8221;:</p>
<pre name="code" class="ruby">
    def test_get_user_info_result
        response_xml = '
        <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
          <soap:Body>
            <GetUserInfoResponse xmlns="http://spokt.com/">
              <GetUserInfoResult>jojojo</GetUserInfoResult>
            </GetUserInfoResponse>
          </soap:Body>
        </soap:Envelope>'

        api = SpoktApi.new
        mock_response(api, response_xml)
        
        result = api.get_user_info("dan")
        assert_equal('jojojo', result)
    end
      

</pre><p>The mock_response method is in my test helper:</p>
<pre name="code" class="ruby">
  def mock_response(api, xml)
    response = Handsoap::Http::Response.new(200,[],xml)
    api.expects(:send_http_request).returns(response)
  end
</pre>
</div>

<div id="disqus">
    <div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/dantech/embed.js"></script><noscript><a href="http://dantech.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>


<div id="related">
  <h3>Possibly Related Posts</h3>
  <ul class="posts">
    
      <li><span>26 Mar 2012</span> &raquo; <a href="/all/life/2012/03/26/steep-learning-curve-is-a-misnomer.html">Steep Learning Curve</a></li>
    
      <li><span>16 Sep 2011</span> &raquo; <a href="/all/rails/2011/09/16/pgerror-unable-to-connect-on-port-5432.html">PGError Unable to connect on port 5432</a></li>
    
      <li><span>07 Feb 2011</span> &raquo; <a href="/all/rails/2011/02/07/slideshowpro-director-ruby-wrapper.html">SlideShowPro Director Ruby API Wrapper</a></li>
    
  </ul>
</div>

<!-- This is for code colorization which doesn't seem to work very well in IE... i guess I don't care very much -->
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shCore.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushRuby.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushPhp.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushXml.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushCss.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushBash.js"></script>
<script language="javascript" src="http://communicatopia.s3.amazonaws.com/js/shBrushJScript.js"></script>
<script language="javascript">
dp.SyntaxHighlighter.ClipboardSwf = 'http://communicatopia.s3.amazonaws.com/js/clipboard.swf';
//name, showGutter, showControls, collapseAll, firstLine , showColumns
dp.SyntaxHighlighter.HighlightAll('code',false, false,false,1,false);
</script>
</div>

<div id="footer">

    Keep in touch with family:<a href="http://www.spokt.com">spokt.com</a> ||
    <a href="ca.linkedin.com/pub/kyle-halladay/2b/658/a14/">Linkedin</a> ||
    <a href="http://twitter.com/khalladay">twitter</a>

<p>&copy; 2010 <a href="/about.html">Kyle Halladay</a>

</div>

</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4105222-2");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>

